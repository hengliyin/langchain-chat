# Chat 功能快速入门

## 🚀 快速开始

### 1. 启动应用

```bash
cd langchain-express-app
npm install  # 或 pnpm install
npm start    # 或 pnpm start
```

应用会在 `http://localhost:3000` 启动

### 2. 访问主页

打开浏览器访问：
```
http://localhost:3000/
```

你会看到应用导航页面，有三个主要功能：

- 💬 **在线 Chat** - 完整的 AI 聊天系统
- 🌊 **流式处理测试** - 流式响应体验
- 📚 **API 文档** - 接口说明（待实现）

### 3. 进入 Chat

点击"在线 Chat"卡片或直接访问：
```
http://localhost:3000/chat.html
```

## 💬 Chat 功能说明

### 界面组成

```
┌─────────────────────────────────────────┐
│  侧边栏              │  主聊天区域        │
│  ────────           │  ─────────        │
│  对话列表            │  [聊天标题]        │
│  新建对话            │  [消息列表]        │
│  模型选择    ────────┼─────────────────  │
│  温度调节           │  [输入框 & 发送]   │
└─────────────────────────────────────────┘
```

### 基本操作

#### 1. 发送消息
- 在输入框输入内容
- 点击"发送"按钮 或 按 `Ctrl+Enter`

```
用户: 什么是人工智能？
AI:  人工智能是指由人制造出来的...（实时生成）
```

#### 2. 创建新对话
- 点击侧边栏"➕ 新建对话"
- 新对话会自动添加到列表

#### 3. 切换对话
- 点击侧边栏中的任意对话
- 对话内容会立即切换

#### 4. 管理对话

**清空对话：**
- 点击右上角"🗑️"按钮
- 确认即可清空当前对话

**导出对话：**
- 点击右上角"📥"按钮
- 对话会以 `.txt` 文件下载

#### 5. 调整参数

**选择模型：**
```
侧边栏 > 模型选择 > 选择你想要的模型
```

**调节温度（创意度）：**
```
侧边栏 > 温度滑块 > 拖动调节
- 0.0 = 最保守（重复答案）
- 0.5 = 平衡
- 1.0 = 最创意
```

**切换响应模式：**
```
输入框下方 > 流式输出 (勾选/取消)
- 勾选 = 实时显示逐字生成
- 取消 = 等待完整响应
```

## 📊 使用场景示例

### 场景 1：学习知识

```
模型: GPT-3.5 Turbo
温度: 0.3
消息: 请用简单的方式解释"闭包"概念

AI: 闭包是指函数和其外部作用域之间的关系...
```

### 场景 2：创意写作

```
模型: GPT-4
温度: 0.8
消息: 给我写一个有趣的故事开头

AI: 在一个雾蒙蒙的早晨，一只会说话的猫出现在...
```

### 场景 3：代码调试

```
模型: GPT-4
温度: 0.2
消息: 这段代码为什么会出错？
     [粘贴代码]

AI: 问题在于第15行的变量未定义...
```

## 🎯 高级技巧

### 1. 对话历史

所有对话都会自动保存到浏览器的 LocalStorage：
- 页面刷新后对话仍存在
- 可以创建多个独立对话
- 每个对话有创建时间戳

### 2. 流式输出优势

```
流式模式：
├─ 实时显示生成过程
├─ 不用等待完整响应
├─ 更好的用户体验
└─ 适合长文本回复

普通模式：
├─ 获得完整响应后显示
├─ 更快获得最终结果
└─ 适合简短回复
```

### 3. 温度参数建议

| 温度 | 适用场景 | 特点 |
|------|--------|------|
| 0.0 | 事实查询 | 确定性高，内容固定 |
| 0.3 | 学习讲解 | 稳定易理解 |
| 0.7 | 通用对话 | 平衡创意和准确性 |
| 0.9 | 创意写作 | 多样化，可能重复 |
| 1.0 | 脑洞创意 | 最多样化，可能不稳定 |

## 🐛 故障排除

### 问题 1：无法连接到 AI 服务

**症状：** 发送消息后显示"❌ 错误"

**解决方案：**
1. 确保后端服务正在运行
2. 检查 API 基础 URL：`http://localhost:3000/api`
3. 查看浏览器控制台错误信息

```javascript
// 在浏览器控制台查看错误
console.log(error.message);
```

### 问题 2：对话历史丢失

**症状：** 刷新页面后对话消失

**解决方案：**
1. 检查是否清除了浏览器缓存
2. 检查 LocalStorage 是否被禁用
3. 尝试在隐私模式下访问

```javascript
// 在浏览器控制台检查
localStorage.getItem('chatHistory')
```

### 问题 3：消息一直没有响应

**症状：** 发送后看不到任何回复

**解决方案：**
1. 等待 AI 处理（可能需要几秒）
2. 检查右下角的加载指示器
3. 查看网络标签页 (F12) 中的请求状态
4. 尝试更换模型或重启浏览器

## 📱 移动设备兼容性

Chat 应用完全响应式设计，支持：

- 📱 手机（<480px）
- 📱 平板（480px-768px）
- 💻 桌面（>768px）

### 移动设备特性

- 侧边栏转移到顶部
- 按钮和文本自动缩放
- 消息宽度自适应
- 手势友好的界面

## 🔄 数据流程图

```
用户输入 → 前端JS处理 → 调用API → 后端LLM
   ↓          ↓          ↓         ↓
  清洗        添加到      HTTP     LLM调用
  校验        消息列表    请求     生成响应
                         ↓
               ← ← ← ← 返回响应 ← ←
                   ↓
              实时流式或
              一次性返回
                   ↓
              前端渲染
              添加动画
                   ↓
              显示给用户
```

## 💾 本地存储说明

对话数据存储位置：
```
浏览器 LocalStorage
├── chatHistory (所有对话)
└── 包括:
    ├── 对话 ID
    ├── 对话标题
    ├── 消息列表
    ├── 创建时间
    └── 每条消息的内容和时间戳
```

## 🎓 学习建议

### 初级
1. 熟悉基本聊天操作
2. 尝试不同的模型
3. 体验流式输出

### 中级
1. 调整温度参数观察变化
2. 保存有用的对话
3. 导出对话进行分析

### 高级
1. 分析 chat.js 源代码
2. 自定义样式和功能
3. 集成到自己的应用

## 📞 获取帮助

1. 查看 `CHAT_FEATURES.md` 获取详细文档
2. 检查浏览器控制台错误信息
3. 查看后端日志
4. 尝试重启应用

## ✨ 更新和改进

关注项目更新获取：
- 新功能发布
- 性能优化
- 安全补丁
- 文档更新

---

**祝你使用愉快！** 🚀
